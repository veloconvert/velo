<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VELO | Pro PDF to Excel</title>
    <meta name="google-site-verification" content="7QSo9l_GthJCi86IIW0CLwarA2KK0AtgZO-WN4PnlTE" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0b0e14; --neon: #00d2ff; --text: #e2e8f0; --card: #111827; --border: #1f2937; }
        body { background-color: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; margin: 0; line-height: 1.6; }
        
        .container { max-width: 1300px; margin: 0 auto; padding: 40px 20px; }
        
        /* HEADER */
        .header { display: flex; justify-content: space-between; align-items: baseline; }
        .brand-logo { 
            font-weight: 800; font-size: 55px; letter-spacing: 12px;
            background: linear-gradient(135deg, #ffffff 0%, #cbd5e1 50%, #ffffff 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .neon-divider { height: 2px; background: var(--neon); box-shadow: 0 0 10px var(--neon); margin: 20px 0 40px 0; }

        /* LAYOUT (STREAMLIT STYLE) */
        .main-grid { display: grid; grid-template-columns: 1fr 300px; gap: 40px; }
        @media (max-width: 900px) { .main-grid { grid-template-columns: 1fr; } }

        /* UPLOADER */
        .upload-section { background: rgba(17, 24, 39, 0.4); border: 2px dashed var(--neon); border-radius: 20px; padding: 60px 20px; text-align: center; transition: 0.3s; cursor: pointer; }
        .upload-section:hover { background: rgba(0, 210, 255, 0.03); }
        .upload-title { color: var(--neon); font-weight: 800; font-size: 18px; letter-spacing: 2px; text-transform: uppercase; }

        /* PREVIEW TABLE (FIXED CLASH) */
        .result-area { margin-top: 40px; display: none; }
        .stats-badge { background: rgba(0, 210, 255, 0.1); color: var(--neon); padding: 8px 16px; border-radius: 8px; font-weight: 600; display: inline-block; margin-bottom: 20px; }
        .table-container { background: #161b22; border: 1px solid var(--border); border-radius: 12px; overflow-x: auto; margin-top: 10px; }
        table { width: 100%; border-collapse: collapse; font-size: 14px; }
        th { background: #1f2937; color: var(--neon); padding: 12px; text-align: left; }
        td { padding: 10px; border-bottom: 1px solid var(--border); color: #8b949e; }

        /* AD REPLACEMENT (SIDEBAR) */
        .ad-sidebar { background: var(--card); border: 1px solid var(--border); border-radius: 12px; height: 600px; display: flex; align-items: center; justify-content: center; color: #374151; font-weight: 700; writing-mode: vertical-rl; }

        /* DOWNLOAD BUTTON (LUSH GREEN) */
        .download-btn { background: #22c55e; color: white; border: none; padding: 16px 32px; border-radius: 10px; font-weight: 800; cursor: pointer; width: 100%; margin-top: 20px; box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3); transition: 0.2s; }
        .download-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(34, 197, 94, 0.4); }

        input[type="file"] { display: none; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div class="brand-logo">VELO</div>
        <div style="color: var(--neon); font-weight: 700; letter-spacing: 2px;">PRO EDITION</div>
    </div>
    <div class="neon-divider"></div>

    <div class="main-grid">
        <div class="main-content">
            <div style="margin-bottom: 40px;">
                <h2 style="font-size: 32px; margin: 0;">Professional PDF Table Extractor</h2>
                <p style="color: #8b949e; font-size: 18px; margin-top: 5px;">Elite Precision Data Conversion</p>
            </div>

            <label class="upload-section" for="pdfInput">
                <div class="upload-title">DRAG & DROP PDF OR CLICK TO UPLOAD</div>
                <div style="margin-top: 10px; font-size: 13px; color: #4b5563;">MAX 500MB CAPACITY • SECURE BROWSER-SIDE PROCESSING</div>
                <input type="file" id="pdfInput" accept="application/pdf">
            </label>

            <div id="resultArea" class="result-area">
                <div id="statsBadge" class="stats-badge"></div>
                <div class="table-container" id="previewContainer">
                    </div>
                <button id="downloadBtn" class="download-btn">✅ READY TO DOWNLOAD EXCEL</button>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 60px;">
                <div style="background: rgba(17, 24, 39, 0.3); padding: 20px; border-radius: 12px; border: 1px solid var(--border);">
                    <h4 style="color: var(--neon); margin: 0 0 10px 0;">1. Upload</h4>
                    <p style="font-size: 13px; color: #8b949e; margin: 0;">Securely upload your PDF tables.</p>
                </div>
                <div style="background: rgba(17, 24, 39, 0.3); padding: 20px; border-radius: 12px; border: 1px solid var(--border);">
                    <h4 style="color: var(--neon); margin: 0 0 10px 0;">2. Extract</h4>
                    <p style="font-size: 13px; color: #8b949e; margin: 0;">Elite engine identifies structures.</p>
                </div>
                <div style="background: rgba(17, 24, 39, 0.3); padding: 20px; border-radius: 12px; border: 1px solid var(--border);">
                    <h4 style="color: var(--neon); margin: 0 0 10px 0;">3. Ready</h4>
                    <p style="font-size: 13px; color: #8b949e; margin: 0;">Download your perfect Excel file.</p>
                </div>
            </div>
        </div>

        <div class="ad-sidebar">
            ADVERTISEMENT SPACE
        </div>
    </div>

    <div style="text-align: center; margin-top: 80px; font-size: 12px; color: #4b5563; border-top: 1px solid var(--border); padding-top: 40px;">
        <p>VELO GLOBAL • 2026</p>
        <p><a href="#" style="color: var(--neon); text-decoration: none;">Privacy Policy</a> | <a href="#" style="color: var(--neon); text-decoration: none;">Terms</a></p>
    </div>
</div>

<script>
    const pdfInput = document.getElementById('pdfInput');
    const resultArea = document.getElementById('resultArea');
    const previewContainer = document.getElementById('previewContainer');
    const statsBadge = document.getElementById('statsBadge');
    const downloadBtn = document.getElementById('downloadBtn');

    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

    pdfInput.onchange = async (e) => {
        const file = e.target.files[0];
        if (!file) return;

        resultArea.style.display = 'none';
        
        const reader = new FileReader();
        reader.onload = async function() {
            const typedarray = new Uint8Array(this.result);
            const pdf = await pdfjsLib.getDocument(typedarray).promise;
            let extractedData = [];

            // İlk sayfadan önizleme verisi çekme
            const page = await pdf.getPage(1);
            const textContent = await page.getTextContent();
            const items = textContent.items.slice(0, 10).map(item => ({ text: item.str }));
            
            // Önizleme Tablosu Oluşturma
            let html = '<table><tr><th>Preview Data</th></tr>';
            items.forEach(item => {
                html += `<tr><td>${item.text || '...'}</td></tr>`;
            });
            html += '</table>';
            
            previewContainer.innerHTML = html;
            statsBadge.innerText = `SUCCESS: ${pdf.numPages} Pages Processed | Tables Identified`;
            resultArea.style.display = 'block';

            // Excel Hazırlama
            const ws = XLSX.utils.json_to_sheet(items);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "VELO_Export");
            downloadBtn.onclick = () => XLSX.writeFile(wb, "velo_export.xlsx");
        };
        reader.readAsArrayBuffer(file);
    };
</script>

</body>
</html>
